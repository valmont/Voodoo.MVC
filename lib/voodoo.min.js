(function(c,d,f,a){var e={version:"0.0.1",init:function(){b()}},b;b=function(){if(typeof d.create!=="function")d.create=function(b){function a(){}a.prototype=b;return new a};if(typeof a.guid!=="function")a.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var b=a.random()*16|0,d=c=="x"?b:b&3|8;return d.toString(16)}).toUpperCase()};if(typeof f.prototype.indexOf==="undefined")f.prototype.indexOf=function(b){for(var a=0;a<this.length;a++)if(this[a]===b)return a;return-1}};if(!c.Voodoo)c.Voodoo=e;e.init()})(window,Object,Array,Math);Voodoo.utils=function(){var a={chkAarg:{}},c,b;b=function(a){throw a;};a.chkAarg.isNotFalsy=function(c,a){!c&&b(a?"Argument cannot be falsy : "+a:"Argument cannot be falsy")};a.chkAarg.isNotUndefined=function(d,a){d===c&&b(a?"Argument cannot be undefined : "+a:"Argument cannot be undefined")};a.chkAarg.isNotEmpty=function(c,a){c===""&&b(a?"Argument cannot be empty : "+a:"Argument cannot be empty")};a.chkAarg.isFunction=function(c,a){typeof c!=="function"&&b(a?"Argument must be a function : "+a:"Argument must be a function")};a.makeArray=function(a){return Array.prototype.slice.call(a,0)};a.each=function(b,c){this.chkAarg.isNotUndefined(b);this.chkAarg.isNotUndefined(c);this.chkAarg.isFunction(c);var a=0,d=b.length;for(a;a<d;a++)if(c(b[a],a)===false)break};return a}(Voodoo);Voodoo.Events=function(a){return{subscribers:{},subscribe:function(d,b){var c=d.split(" ");a.each(c,this.proxy(function(a){(this.subscribers[a]||(this.subscribers[a]=[])).push(b)}))},publish:function(){var c=a.makeArray(arguments),e=c.shift(),b=this.subscribers,d=b[e];if(!b)return false;if(!d)return false;a.each(d,this.proxy(function(a){if(a.apply(this,c)===false)return false}));return true},forget:function(c,d){if(!c){this.subscribers={};return this}var e=this.subscribers,b=e[c];if(!e)return false;if(!b)return false;if(!d){delete this.subscribers[c];return this}a.each(b,this.proxy(function(a,c){if(d===a){b.splice(c,1);return false}}));return this}}}(Voodoo.utils);Voodoo.Module=Voodoo.App=function(d,e){var a,b=d.utils,c=["included","extended"];a={inherited:function(){},created:function(){},prototype:{init:function(){},initializer:function(){}},extend:function(b){for(var a in b)if(c.indexOf(a)==-1)this[a]=b[a];var d=b.extended;d&&d.apply(this);return this},include:function(b){for(var a in b)if(c.indexOf(a)==-1)this.prototype[a]=b[a];var d=b.included;d&&d.apply(this);return this},proxy:function(a){b.chkAarg.isNotUndefined(a);var c=this;return function(){var d=b.makeArray(arguments);d.length>0&&d[0].target!=="undefined"&&d.push(e(d[0].target));a.apply(c,d)}},proxyAll:function(){for(var c=b.makeArray(arguments),a=0;a<c.length;a++)this[c[a]]=this.proxy(this[c[a]])},create:function(b,c){var a=Object.create(this);a.parent=this;a.prototype=a.fn=Object.create(this.prototype);b&&a.include(b);c&&a.extend(c);a.created();this.inherited(a);return a},init:function(){var a=Object.create(this.prototype);a.parent=this;a.initializer.apply(a,arguments);a.init.apply(a,arguments);return a}};a.prototype.proxy=a.proxy;a.prototype.proxyAll=a.proxyAll;a.base=a.create;return a}(Voodoo,jQuery);Voodoo.Controller=Voodoo.App=function(c,a){var b=c.Module.base(c.Events);b.include({eventSplitter:/^(\S+)\s*(.*)$/,initializer:function(b){if(this.root)this.root=a(this.root);if(b){this.root=this.root||(b.root?a(b.root):a("body"));for(var c in b)this[c]=b[c]}if(!this.events)this.events=this.parent.events;if(!this.elements)this.elements=this.parent.elements;this.events&&this.delegateEvents();this.elements&&this.bindElements();this.proxied&&this.proxyAll.apply(this,this.proxied)},delegateEvents:function(){var f,c,e,d,b;for(f in this.events){c=this.events[f];e=f.match(this.eventSplitter);d=e[1],b=e[2];if(b==="")this.root.bind(d,this.proxy(this[c]));else this.root.delegate(b,d,method=this.proxy(this[c],a(b)))}},bindElements:function(){var b;for(b in this.elements)this[this.elements[b]]=a(b)}});return b}(Voodoo,jQuery);Voodoo.Model=function(d,a){var b=a.Module.base(),c=a.utils;b.extend(a.Events);b.extend({created:function(){this.records={};this.attributes=[];this.subscribe("create",this.proxy(function(a){this.publish("change","create",a)}));this.subscribe("update",this.proxy(function(a){this.publish("change","update",a)}));this.subscribe("destroy",this.proxy(function(a){this.publish("change","destroy",a)}))},generateIds:false,find:function(b){a.check.arg.isNotFalsy(b,"Model.find");var c=this.records[b];if(!c)throw"Entity not found with id "+b;return c.clone()},first:function(){var a=this.recordsValues()[0];return a&&a.clone()},last:function(){var b=this.recordsValues(),a=b[b.length-1];return a&&a.clone()},all:function(){return this.cloneArray(this.recordsValues())},sync:function(a){this.subscribe("change",a)},fetch:function(a){a?this.subscribe("fetch",a):this.publish("fetch")},populate:function(d){this.records={};var b=this,a;c.each(d,function(c){a=b.init(c);a.newRecord=false;b.records[a.id]=a})},configure:function(){var a,b;b=arguments[0],a=2<=arguments.length?Array.prototype.slice.call(arguments,1):[];this.className=b;this.records={};this.attributes=a},update:function(b,a){this.find(b).updateAttributes(a)},create:function(b){var a=this.init(b);a.save();return a},recordsValues:function(){var a=[];for(var b in this.records)a.push(this.records[b]);return a},cloneArray:function(c){for(var b=[],a=0;a<c.length;a++)b.push(c[a].dup());return b}});b.include({newRecord:true,mopdel:true,validate:function(){},isValid:function(){},init:function(a){a&&this.load(a)},load:function(a){for(var b in a)this[b]=a[b]},attributes:function(){for(var a={},b=0;b<this.parent.attributes.length;b++){var c=this.parent.attributes[b];a[c]=this[c]}a.id=this.id;return a},toJSON:function(){return this.attributes()},destroy:function(){this.publish("beforeDestroy",this);delete this.parent.records[this.id];this.publish("destroy",this)},eql:function(a){return a&&a.id===this.id&&a.parent===this.parent},save:function(){var a=this.validate();if(a)if(!this.publish("error",this,a))throw"Validation failed: "+a;this.publish("beforeSave",this);this.newRecord?this.create():this.update();this.publish("save",this);return this},updateAttribute:function(b,a){this[b]=a;return this.save()},updateAttributes:function(a){this.load(a);return this.save()},clone:function(){return Object.create(this)},dup:function(){var a=this.parent.init(this.attributes());a.newRecord=this.newRecord;return a},copy:function(){var b={};for(var a in this)if(this.hasOwnProperty(a)&&a!=="parent")b[a]=this[a];return b},create:function(){if(!this.id)this.id=Math.guid();this.newRecord=false;var a=this.parent.records;a[this.id]=this.dup();this.publish("create",a[this.id].clone())},update:function(){var a=this.parent.records;a[this.id]=this.clone();a[this.id].load(this.attributes());this.publish("update",a[this.id].clone())},subscribe:function(b,a){return this.parent.subscribe(b,this.proxy(function(b){b&&this.eql(b)&&a.apply(this,arguments)}))},publish:function(){return this.parent.publish.apply(this.parent,arguments)},post:function(b,c){a.utils.chkAarg.isNotUndefined(b,"Model.post");this.ajax(b,c,"post")},"get":function(b,c){a.utils.chkAarg.isNotUndefined(b,"Model.post");this.ajax(b,c,"get")},ajax:function(e,a,b){var c=a?this.proxy(a):a;d[b](e,this.copy(),c)}});return b}(jQuery,Voodoo);Voodoo.Route=function(a,c){var b=a.Module.base(),g=/^#*/;b.extend({routes:[],historySupport:"history"in window,history:false,add:function(a,c){if(typeof a=="object")for(var b in a)this.add(b,a[b]);else this.routes.push(this.init(a,c))},setup:function(a){if(a&&a.history)this.history=this.historySupport&&a.history;if(this.history)c(window).bind("popstate",this.change);else c(window).bind("hashchange",this.change);this.change()},unbind:function(){if(this.history)c(window).unbind("popstate",this.change);else c(window).unbind("hashchange",this.change)},navigate:function(){var b=a.utils.makeArray(arguments),d=false;if(typeof b[b.length-1]=="boolean")d=b.pop();var c=b.join("/");if(this.path==c)return;if(!d)this.path=c;if(this.history)history.pushState({},document.title,this.getHost()+c);else window.location.hash=c},getPath:function(){return window.location.pathname},getHash:function(){return window.location.hash},getHost:function(){return(document.location+"").replace(this.getPath()+this.getHash(),"")},getFragment:function(){return this.getHash().replace(g,"")},change:function(){var a=this.history?this.getPath():this.getFragment();if(a==this.path)return;this.path=a;for(var b=0;b<this.routes.length;b++)if(this.routes[b].match(a))return}});b.proxyAll("change");var e=/:([\w\d]+)/g,f=/\*([\w\d]+)/g,d=/[-[\]{}()+?.,\\^$|#\s]/g;b.include({init:function(a,b){this.callback=b;if(typeof a=="string"){a=a.replace(d,"\\$&").replace(e,"([^/]*)").replace(f,"(.*?)");this.route=new RegExp("^"+a+"$")}else this.route=a},match:function(c){var a=this.route.exec(c);if(!a)return false;var b=a.slice(1);this.callback.apply(this.callback,b);return true}});a.Controller.fn.route=a.App.fn.route=function(c,b){a.Route.add(c,this.proxy(b))};a.Controller.fn.routes=a.App.fn.routes=function(a){for(var b in a)this.route(b,a[b]);return this};a.Controller.fn.navigate=a.App.fn.navigate=function(){a.Route.navigate.apply(a.Route,arguments)};a.Controller.fn.setupRoutes=a.App.fn.setupRoutes=function(){a.Route.setup.apply(a.Route,arguments)};return b}(Voodoo,jQuery);Voodoo.Obatala=function(a,d,e){var b=a.Module.base(a.Events),c=a.utils;b.include({addAll:function(){for(var b=c.makeArray(arguments),a=0;a<b.length;a++)this.add(b[a])},add:function(a){this.subscribe("changeState",function(b){if(a==b)a.activate();else a.deactivate()});a.active=this.proxy(function(){a.pageLoad&&a.pageLoad();this.publish("changeState",a)})}});a.Controller.include({active:function(a){typeof a=="function"?this.subscribe("active",a):this.publish("active");return this},isActive:function(){return this.root.hasClass("active")},activate:function(){d.title=this.title||e.location;this.root.addClass("active");return this},deactivate:function(){this.root.removeClass("active");return this}});return b}(Voodoo,document,window)